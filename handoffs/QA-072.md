# 1. Metadata
1. Task ID: QA-072
2. Title: QA-attempt isolation/cleanup pipeline + canonical-domain/regression verification
3. Owner Agent: QA
4. Handoff Date: 2026-02-26
5. Proposed Next State: `REVIEW`

# 2. Summary of Work
1. What was completed:
1. Updated QA suites to support strict source tagging (`attemptSource: "qa"` + optional QA header token), source-aware assertions, and auto-cleanup archive.
2. Added dedicated cleanup utility [qa/cleanup_qa_attempts.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/cleanup_qa_attempts.mjs).
3. Integrated cleanup into release orchestrators:
[qa/run_after_deploy.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/run_after_deploy.mjs),
[qa/release_gate.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/release_gate.mjs).
4. Updated QA documentation and scripts inventory.
5. Ran static gates after all changes.
2. What was intentionally not done: full remote `qa:release-gate`/`qa:after-deploy` execution was not run in this local pass because deployment credentials/runtime env are external.

# 3. Files and Artifacts
1. Files changed:
[package.json](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/package.json)
[qa/README.md](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/README.md)
[qa/remote_smoke.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/remote_smoke.mjs)
[qa/matrix_ui_network.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/matrix_ui_network.mjs)
[qa/data_integrity_audit.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/data_integrity_audit.mjs)
[qa/load_profile_500.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/load_profile_500.mjs)
[qa/run_after_deploy.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/run_after_deploy.mjs)
[qa/release_gate.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/release_gate.mjs)
[qa/cleanup_qa_attempts.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/cleanup_qa_attempts.mjs)
2. New files:
[qa/cleanup_qa_attempts.mjs](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/qa/cleanup_qa_attempts.mjs)
[handoffs/QA-072.md](/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/handoffs/QA-072.md)
3. Commands executed:
1. `npm --prefix web run typecheck`
2. `npm --prefix web run lint`
3. `npm --prefix web run build`

# 4. Validation Evidence
1. Tests run: static gates above.
2. Test results: all passed locally.
3. Manual checks: verified QA scripts now call list/summary with `source=all` where QA-created data must be asserted.

# 5. Downstream Impact
1. Tasks unblocked: PM-UX-ANL-013
2. Interfaces changed: none beyond QA harness behavior.
3. Migration or deployment impacts: recommend setting `QA_SOURCE_TOKEN` in runtime environments used for automated QA.

# 6. Open Issues
1. Known issues: none found in static checks.
2. Risks: without `QA_SOURCE_TOKEN`, scripts still work but rely on cleanup/archive instead of strict source tagging.
3. Follow-up required: run post-deploy `qa:after-deploy` once pushed.

# 7. Requested PM Action
1. Mark as `DONE`
