# Handoff: BE-006

## 1. Metadata
1. Task ID: `BE-006`
2. Title: Implement Google TTS edge integration + cache
3. Owner Agent: Backend
4. Handoff Date: 2026-02-24
5. Proposed Next State: `BLOCKED`

## 2. Summary of Work
1. Implemented `student-question-audio` function for TTS retrieval.
2. Added caching logic:
1. hash cache key from voice settings + text
2. storage object path `baseline_v1/<hash>.mp3`
3. signed URL return for cached files
3. Added synthesis path using Google Text-to-Speech REST API.
4. Added bucket ensure/create path for `tts-audio` (configurable via env).

## 3. Files and Artifacts
1. Files changed:
1. `/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/supabase/functions/student-question-audio/index.ts`
2. `/Users/akashdatta/Desktop/prod-vocabpal-baseline-500/supabase/functions/_shared/auth.ts`
2. Deploy command:
1. `npx supabase functions deploy student-question-audio --use-api --no-verify-jwt --project-ref efbmcxadmdarzlfxjjsd`

## 4. Validation Evidence
1. Function deployed and reachable.
2. With missing GCP key, endpoint returns deterministic config error:
1. `Google TTS is not configured. Set GOOGLE_TTS_API_KEY to enable synthesis.`

## 5. Downstream Impact
1. Endpoint contract is ready for UI integration.
2. Full synthesis path is pending credential checkpoint completion.

## 6. Open Issues
1. Blocked on `CP-03-GCP-TTS`:
1. enable TTS API
2. provide `GOOGLE_TTS_API_KEY` (or alternative service-account path)
2. Voice tuning (`en-IN` female variant) to be confirmed once key is set.

## 7. Requested PM Action
1. Keep `BE-006` in `BLOCKED`.
2. Trigger `CP-03` checkpoint request.
